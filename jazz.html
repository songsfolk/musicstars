<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>El Alma del Jazz</title>
<!-- Fuentes e Iconos -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<style>
    /* =========================================
       ESTILOS DEL BLOG DE JAZZ (P√öBLICO)
       ========================================= */
    body {
        font-family: 'Georgia', serif;
        background-color: #1e1e1e;
        color: #f0e6d2;
        margin: 0;
        padding: 20px;
        line-height: 1.6;
    }

    h1 {
        text-align: center;
        color: #d4af37;
        font-size: 2.5em;
        margin-bottom: 20px;
    }
    h2 {
        color: #d4af37;
        font-size: 1.8em;
        margin-top: 30px;
    }
    .container {
        max-width: 900px;
        margin: 0 auto;
        background-color: #2b2b2b;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
    p { font-size: 1.1em; margin: 15px 0; }
    
    /* Figuras (Artistas) */
    .figure { display: flex; align-items: center; margin: 20px 0; }
    .figure img { width: 150px; height: 150px; object-fit: cover; border-radius: 50%; margin-right: 20px; border: 2px solid #d4af37; }
    .figure-text { flex: 1; }
    
    /* Listas y Enlaces */
    ul { list-style-type: none; padding: 0; }
    li { margin: 10px 0; font-style: italic; }
    a.song-link { color: #87ceeb; text-decoration: none; }
    a.song-link:hover { color: #b0e0e6; text-decoration: underline; }

    /* =========================================
       EL CAMUFLAJE PERFECTO (MODIFICADO)
       ========================================= */
    a.secret-link { 
        color: inherit; /* Hereda el color del texto normal (no parece un link) */
        text-decoration: none; /* Sin subrayado */
        cursor: text; /* El cursor se queda como "texto", no cambia a "mano" */
    }
    a.secret-link:hover {
        color: inherit; /* No cambia de color al pasar el rat√≥n */
        text-decoration: none;
    }

    /* Estilos del Chat P√∫blico (Comentarios del Blog) */
    .chat-container { display: flex; flex-direction: column; align-items: center; width: 100%; }
    #chat-publico { 
        overflow-y: auto; 
        max-height: 300px; 
        padding: 10px; 
        width: 100%; 
        box-sizing: border-box; 
        background-color: #3a3a3a; 
        border-radius: 5px; 
        margin-bottom: 10px; 
    }
    .input-container { display: flex; justify-content: center; align-items: center; width: 100%; margin-top: 5px; }
    #mensajeInputPublico { width: 70%; resize: none; height: 40px; background-color: #f0e6d2; color: #1e1e1e; padding: 5px; border-radius: 5px; border: 1px solid #555; font-family: 'Georgia', serif; }
    #enviarMensajePublico { padding: 8px 12px; margin-left: 5px; background-color: #d4af37; color: #1e1e1e; border: none; cursor: pointer; border-radius: 5px; height: 40px; font-weight: bold; }
    
    /* Estilo de cada comentario p√∫blico */
    .mensaje-item { 
        text-align: left; 
        margin: 8px 0; 
        padding: 10px; 
        background-color: #2b2b2b; 
        border-bottom: 1px solid #444; 
    }
    .mensaje-item p { margin: 0; font-size: 1em; } 
    .mensaje-item strong { color: #d4af37; } /* Nombre en dorado */
    .fecha-comentario { font-size: 0.8em; color: #888; margin-left: 10px; }

    /* Media Queries */
    @media (max-width: 600px) {
        h1 { font-size: 2em; }
        h2 { font-size: 1.5em; }
        .container { padding: 15px; }
        .figure { flex-direction: column; text-align: center; }
        .figure img { margin: 0 0 10px 0; width: 120px; height: 120px; }
    }
</style>
</head>
<body>

<!-- CONTENEDOR PRINCIPAL (FACHADA) -->
<div class="container">
    <h1>El Alma del Jazz</h1>
    <p>El jazz no es solo m√∫sica; es una forma de vida, un reflejo del alma humana en notas improvisadas y ritmos que laten al comp√°s del coraz√≥n. Surgi√≥ a finales del siglo XIX en las calles vibrantes de Nueva Orleans, donde las influencias del blues, el ragtime y las tradiciones africanas se fusionaron en un sonido √∫nico. Desde los clubes llenos de humo hasta los grandes escenarios del mundo, el jazz ha evolucionado, pero nunca ha perdido su esencia: la libertad de expresi√≥n.</p>
    <p>Este g√©nero ha dado lugar a momentos inolvidables y artistas que han trascendido el tiempo. A lo largo de los a√±os, el jazz ha sabido adaptarse, desde el swing de los a√±os 30 hasta el bebop de los 40 y el cool jazz de los 50. Es un arte que invita a escuchar con atenci√≥n, a sentir cada nota como si contara una historia. A continuaci√≥n, exploraremos a tres de sus figuras m√°s emblem√°ticas y una selecci√≥n de canciones que capturan su esp√≠ritu.</p>
    
    <h2>Figuras Ic√≥nicas del Jazz</h2>
    <div class="figure">
        <img alt="Frank Sinatra" src="https://i.imgur.com/DgMHCSb.jpeg"/>
        <div class="figure-text">
            <p><strong>Frank Sinatra</strong>, conocido como "La Voz", llev√≥ el jazz a nuevas alturas con su estilo suave y su habilidad para interpretar canciones con una emoci√≥n profunda. Aunque tambi√©n fue un √≠cono del pop, su contribuci√≥n al jazz vocal es innegable, especialmente en temas como "Fly Me to the Moon", donde su phrasing impecable brilla.</p>
        </div>
    </div>
    <div class="figure">
        <img alt="Ella Fitzgerald" src="https://i.imgur.com/101yBqK.jpeg"/>
        <div class="figure-text">
            <p><strong>Ella Fitzgerald</strong>, la "Primera Dama de la Canci√≥n", revolucion√≥ el jazz con su voz cristalina y su dominio del scat, una t√©cnica de improvisaci√≥n vocal que convirti√≥ en arte. Canciones como "Summertime" muestran su capacidad para transformar melod√≠as en pura magia.</p>
        </div>
    </div>
    <div class="figure">
        <img alt="Louis Armstrong" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Louis_Armstrong_restored.jpg/220px-Louis_Armstrong_restored.jpg"/>
        <div class="figure-text">
            <p><strong>Louis Armstrong</strong>, apodado "Satchmo", fue un pionero del jazz con su trompeta y su voz grave y carism√°tica. Su interpretaci√≥n de "What a Wonderful World" no solo es un himno de esperanza, sino una muestra de c√≥mo el jazz puede tocar el alma.</p>
        </div>
    </div>
    
    <h2>Canciones que Definen el Jazz</h2>
    <p>El jazz vive en sus melod√≠as, y estas canciones son un testimonio de su diversidad y belleza. Escucha estas piezas y d√©jate llevar por su encanto:</p>
    <ul>
        <li><a class="song-link" href="https://www.youtube.com/watch?v=A3yCcXgbKrE" target="_blank">"What a Wonderful World" - Louis Armstrong</a></li>
        <li><a class="song-link" href="https://www.youtube.com/watch?v=u2bigf337aU" target="_blank">"Summertime" - Ella Fitzgerald</a></li>
        <li><a class="song-link" href="https://www.youtube.com/watch?v=ZEcqHA7dbwM" target="_blank">"Fly Me to the Moon" - Frank Sinatra</a></li>
        <li><a class="song-link" href="https://www.youtube.com/watch?v=vmDDOFXSgAs&amp;pp=ygUJdGFrZSBmaXZl" target="_blank">"Take Five" - Dave Brubeck</a></li>
        <li><a class="song-link" href="https://www.youtube.com/watch?v=ylXk1LBvIqU" target="_blank">"So What" - Miles Davis</a></li>
    </ul>
    
    <h2>Comentarios</h2>
    <div class="chat-container">
        <!-- Contenedor donde aparecer√°n los comentarios -->
        <div id="chat-publico"></div>
        
        <div class="input-container">
            <textarea id="mensajeInputPublico" placeholder="Deja tu comentario..." rows="1"></textarea> 
            <button id="enviarMensajePublico">Enviar</button>
        </div>
    </div>
    
    <h2>Un Legado Eterno</h2>
    <p>El jazz es un g√©nero que nunca envejece. Cada acorde, cada improvisaci√≥n, lleva consigo las historias de quienes lo crearon y lo vivieron. Desde los bares clandestinos de la Prohibici√≥n hasta las salas de concierto modernas, su esp√≠ritu sigue resonando. Es un recordatorio de que la m√∫sica puede ser un refugio, una protesta o una celebraci√≥n, todo al mismo tiempo.</p>
    
    <!-- EL SECRETO: El id="palabra-secreta" activa el login -->
    <p>Si te apasiona este arte, sum√©rgete en sus ra√≠ces, descubre sus leyendas y d√©jate envolver por sus <a class="secret-link" href="#" id="palabra-secreta">melod√≠as</a>.</p>
</div>

<!-- SCRIPT 1: L√ìGICA LOCAL (Comentarios p√∫blicos y Trigger) -->
<script>
    // 1. L√≥gica de Comentarios P√∫blicos
    // Comentarios "Hist√≥ricos" fijos para dar realismo
    const comentariosHistoricos = [
        { usuario: "JazzFanatic", mensaje: "¬°Qu√© gran interpretaci√≥n de Miles Davis en So What!", fecha: "hace 57 semanas" },
        { usuario: "MusicLover", mensaje: "Summertime de Ella Fitzgerald es pura magia. ‚ú®", fecha: "hace 46 semanas" },
        { usuario: "Juan R.", mensaje: "Take Five siempre me pone de buen humor. ¬°Un cl√°sico!", fecha: "hace 32 semanas" },
        { usuario: "SmoothJazz", mensaje: "Frank Sinatra tiene una voz inconfundible. Fly me to the moon! üöÄ", fecha: "hace 10 semanas" }
    ];

    const chatPublicoDiv = document.getElementById("chat-publico");

    function agregarComentarioAlDOM(usuario, mensaje, fecha) {
        const div = document.createElement("div");
        div.classList.add("mensaje-item");
        // Usamos innerHTML para permitir emojis, pero en un entorno real habr√≠a que sanitizar.
        // Como esto es local y p√∫blico sin base de datos, es seguro.
        div.innerHTML = `<p><strong>${usuario}</strong> <span class="fecha-comentario">${fecha}</span></p><p>${mensaje}</p>`;
        chatPublicoDiv.appendChild(div);
        chatPublicoDiv.scrollTop = chatPublicoDiv.scrollHeight; // Scroll al final
    }

    // Cargar los comentarios hist√≥ricos al iniciar
    comentariosHistoricos.forEach(c => agregarComentarioAlDOM(c.usuario, c.mensaje, c.fecha));

    // L√≥gica para a√±adir NUEVOS comentarios (Persistentes en la sesi√≥n)
    const btnPublico = document.getElementById("enviarMensajePublico");
    const inputPublico = document.getElementById("mensajeInputPublico");

    btnPublico.addEventListener("click", () => {
        const texto = inputPublico.value.trim();
        if (texto) {
            // Se a√±ade bajo el nombre "Usuario" y la fecha "ahora mismo"
            agregarComentarioAlDOM("Usuario", texto, "ahora mismo");
            inputPublico.value = ""; // Limpiar input
        }
    });

    // Permitir enviar con Enter
    inputPublico.addEventListener("keypress", (e) => {
        if (e.key === "Enter" && !e.shiftKey) {
            e.preventDefault();
            btnPublico.click();
        }
    });
</script>

<!-- =========================================
     PARTE 2: LA SECCI√ìN SECRETA (DISE√ëO 3D & ELEGANCIA)
     ========================================= -->

<!-- Estilos exclusivos para la parte privada -->
<style>
    :root {
        --bg-deep: #0f0f12;       /* Fondo casi negro */
        --card-bg: #1a1a20;       /* Fondo tarjetas */
        --accent: #b48efc;        /* Violeta elegante */
        --gold: #d4af37;          /* Dorado Jazz */
        --glass: rgba(255, 255, 255, 0.05); /* Efecto cristal */
        --shadow-3d: 0 10px 20px rgba(0,0,0,0.5), 0 6px 6px rgba(0,0,0,0.3);
        --shadow-inset: inset 2px 2px 5px rgba(0,0,0,0.5), inset -2px -2px 5px rgba(255,255,255,0.05);
    }

    /* El Contenedor Maestro (Invisible por defecto) */
    #seccion-secreta {
        display: none; /* Se activa con JS */
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: radial-gradient(circle at center, #1f1f2e 0%, #000000 100%);
        z-index: 9999;
        overflow-y: auto;
        animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

    /* --- LOGIN FLOTANTE 3D --- */
    .login-container {
        display: flex; justify-content: center; align-items: center; height: 100vh;
    }
    .login-box {
        background: var(--card-bg);
        padding: 40px;
        border-radius: 20px;
        width: 90%; max-width: 380px;
        text-align: center;
        box-shadow: var(--shadow-3d); /* Sombra profunda */
        border: 1px solid rgba(255,255,255,0.05);
        transform: perspective(1000px) rotateX(2deg); /* Sutil inclinaci√≥n 3D */
        transition: transform 0.3s ease;
    }
    .login-box:hover { transform: perspective(1000px) rotateX(0deg) translateY(-5px); }

    /* Inputs con efecto "Hundido" (Neumorfismo Dark) */
    .input-3d {
        width: 100%; padding: 15px; margin: 10px 0;
        background: #121216;
        border: none; border-radius: 12px;
        color: #fff; font-family: 'Segoe UI', sans-serif;
        box-shadow: var(--shadow-inset); /* Sombra interior */
        transition: 0.3s;
    }
    .input-3d:focus { outline: none; box-shadow: 0 0 0 2px var(--accent); }

    /* Botones con efecto "Elevado" */
    .btn-3d {
        background: linear-gradient(145deg, #6c5ce7, #8e44ad);
        color: white; border: none;
        padding: 12px 25px; border-radius: 50px;
        font-weight: bold; letter-spacing: 1px;
        cursor: pointer; width: 100%; margin-top: 15px;
        box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
        transition: transform 0.1s, box-shadow 0.1s;
    }
    .btn-3d:active { transform: scale(0.95); box-shadow: 0 2px 5px rgba(108, 92, 231, 0.4); }
    
    .btn-secondary { background: #333; box-shadow: none; width: auto; font-size: 0.8em; }

    /* --- INTERFAZ PRINCIPAL (APP) --- */
    .app-layout {
        max-width: 850px; margin: 0 auto; padding: 20px;
        color: #ddd; font-family: 'Segoe UI', sans-serif;
    }

    .header-bar {
        display: flex; justify-content: space-between; align-items: center;
        padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);
        margin-bottom: 30px;
    }

    /* Tarjetas Flotantes */
    .card-3d {
        background: var(--card-bg);
        border-radius: 15px;
        padding: 25px; margin-bottom: 25px;
        box-shadow: var(--shadow-3d);
        border: 1px solid rgba(255,255,255,0.05);
        transition: transform 0.3s ease;
    }
    .card-3d:hover { transform: translateY(-5px); } /* Levitar al pasar rat√≥n */

    /* Panel Admin */
    .admin-stats {
        display: flex; gap: 10px; flex-wrap: wrap; font-size: 0.85em;
        background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px;
    }

    /* M√∫sica */
    .music-links { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
    .music-btn {
        text-decoration: none; color: var(--gold);
        background: rgba(212, 175, 55, 0.1);
        padding: 8px 15px; border-radius: 20px;
        border: 1px solid var(--gold); transition: 0.3s;
    }
    .music-btn:hover { background: var(--gold); color: #000; box-shadow: 0 0 10px var(--gold); }

    /* --- CHAT 3D --- */
    .chat-window {
        background: #111;
        height: 450px;
        border-radius: 12px;
        padding: 20px;
        overflow-y: auto;
        box-shadow: var(--shadow-inset); /* Chat hundido */
        display: flex; flex-direction: column; gap: 15px;
        /* Textura sutil de fondo */
        background-image: radial-gradient(#2a2a35 1px, transparent 1px);
        background-size: 20px 20px;
    }

    .msg-bubble {
        max-width: 80%; padding: 12px 18px;
        border-radius: 18px; font-size: 0.95em;
        position: relative; word-wrap: break-word;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3); /* Sombra para dar volumen */
    }
    .msg-bubble img { 
        max-width: 100%; border-radius: 10px; 
        border: 1px solid rgba(255,255,255,0.2); margin-top: 5px; 
    }
    
    /* PDF Styling en chat */
    .pdf-attachment {
        display: flex; align-items: center; gap: 10px;
        background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;
    }

    .msg-mio {
        align-self: flex-end;
        background: linear-gradient(135deg, #6c5ce7, #a29bfe);
        color: white; border-bottom-right-radius: 4px;
    }
    .msg-otro {
        align-self: flex-start;
        background: linear-gradient(135deg, #2d3436, #636e72);
        color: #ecf0f1; border-bottom-left-radius: 4px;
    }
    .msg-name { font-size: 0.7em; opacity: 0.8; margin-bottom: 4px; display: block; font-weight: bold; }

    /* √Årea de Input del Chat */
    .input-bar {
        display: flex; align-items: center; gap: 10px; margin-top: 15px;
        background: var(--card-bg); padding: 5px; border-radius: 30px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        border: 1px solid rgba(255,255,255,0.05);
    }
    #mensajeInput {
        flex: 1; background: transparent; border: none; color: white;
        padding: 10px; font-size: 1em; height: 20px; resize: none;
    }
    #mensajeInput:focus { outline: none; }
    
    .action-btn {
        background: transparent; border: none; color: #888;
        font-size: 1.2em; cursor: pointer; padding: 0 10px; transition: 0.3s;
    }
    .action-btn:hover { color: var(--accent); transform: scale(1.1); }

    /* Utilidades */
    .hidden { display: none !important; }
    .text-center { text-align: center; }
</style>

<div id="seccion-secreta">
    
    <!-- PANTALLA DE LOGIN (Visible si no hay sesi√≥n) -->
    <div id="loginContainer" class="login-container">
        <div class="login-box">
            <h2 style="color:var(--accent); font-family: 'Playfair Display', serif;">Bienvenida</h2>
            <p style="color:#888; font-size:0.9em; margin-bottom:20px;">Espacio reservado para Estrellita y Luna</p>
            
            <input type="email" id="email" class="input-3d" placeholder="Correo electr√≥nico">
            <div style="position:relative;">
                <input type="password" id="password" class="input-3d" placeholder="Contrase√±a">
                <span id="togglePassword" style="position:absolute; right:15px; top:18px; cursor:pointer; color:#666;">üëÅ</span>
            </div>
            
            <button id="login" class="btn-3d">Iniciar Sesi√≥n</button>
            <p id="loginError" style="color:#e74c3c; font-size:0.9em; margin-top:10px; min-height:20px;"></p>
        </div>
    </div>

    <!-- PANTALLA PRINCIPAL (APP) (Visible al loguearse) -->
    <div id="contenido-secreto" class="app-layout hidden">
        
        <!-- Cabecera -->
        <div class="header-bar">
            <div>
                <h2 style="margin:0; font-family: 'Playfair Display', serif; color:white;">
                    Hola, <span id="nombre-usuario" style="color:var(--accent);">Amor</span> ‚ú®
                </h2>
                <small style="color:#777;">Bienvenida a casa</small>
            </div>
            <button id="logout" class="btn-3d btn-secondary">Cerrar Sesi√≥n</button>
        </div>

        <!-- PANEL ADMIN (Solo visible para Luna) -->
        <div id="admin-info" class="card-3d hidden">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <h3 style="margin:0; color:var(--gold);">üëë Panel de Luna</h3>
                <button id="borrarChatBtn" style="background:#c0392b; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer; font-size:0.8em;">‚ö†Ô∏è Borrar Chat</button>
            </div>
            <div id="contadores-container" class="admin-stats">
                <!-- Aqu√≠ se inyectan las estad√≠sticas -->
                Cargando datos...
            </div>
        </div>

        <!-- TARJETA 1: EMOCIONES -->
        <div class="card-3d">
            <h3 style="margin-top:0; color:#ddd;">¬øC√≥mo te sientes hoy?</h3>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                <select id="emocion" class="input-3d" style="flex:1; margin:0; padding:10px;">
                    <option value="feliz">Feliz üòä</option>
                    <option value="triste">Triste üòî</option>
                    <option value="estresada">Estresada üòµ‚Äçüí´</option>
                    <option value="cansada">Cansada ü•±</option>
                    <option value="extra√±andote">Extra√±√°ndote ü•∫</option>
                    <option value="pensandoEnTi">Pensando en ti üí≠‚ù§Ô∏è</option>
                    <option value="conGanasDeVerte">Con ganas de verte ü•∞</option>
                    <option value="conGanasDePensar">Con ganas de "pensar" üòè</option>
                </select>
                <button onclick="mostrarMensaje()" class="btn-3d" style="width:auto; margin:0; padding:10px 20px;">Ver Mensaje</button>
            </div>
            
            <div id="mensaje" style="margin-top:15px; padding:15px; border-left:3px solid var(--accent); background:rgba(180, 142, 252, 0.1); color:var(--accent); font-style:italic; display:none;"></div>
            
            <div style="margin-top:15px; display:flex; justify-content:space-between; align-items:center;">
                <div class="music-links">
                    <a href="https://youtu.be/M7k5tjw3-0M" target="_blank" class="music-btn"><i class="fas fa-music"></i> Piano</a>
                    <a href="https://www.youtube.com/watch?v=ITbjjKDDSO0" target="_blank" class="music-btn"><i class="fas fa-heart"></i> Nuestra</a>
                </div>
                <button onclick="mostrarPoema()" style="background:none; border:none; color:#777; cursor:pointer;">üìú Poema</button>
            </div>
            <div id="poema" style="margin-top:10px; color:var(--gold); font-style:italic; white-space:pre-wrap; font-size:0.9em; display:none;"></div>
        </div>

        <!-- TARJETA 2: CHAT 3D -->
        <div class="card-3d" style="border: 1px solid var(--accent);">
            <h3 style="margin-top:0; color:var(--accent);">Nuestro Chat Privado</h3>
            
            <!-- Ventana de mensajes -->
            <div id="chat" class="chat-window">
                <!-- Aqu√≠ aparecer√°n los mensajes din√°micamente -->
            </div>

            <!-- Barra de entrada -->
            <div class="input-bar">
                <!-- INPUT OCULTO PARA ARCHIVOS -->
                <input type="file" id="imageInput" accept="image/*, application/pdf" style="display:none;">
                
                <!-- Bot√≥n Clip -->
                <button id="btnUpload" class="action-btn" title="Adjuntar foto o PDF">
                    <i class="fas fa-paperclip"></i>
                </button>
                
                <!-- Campo de texto -->
                <textarea id="mensajeInput" placeholder="Escribe un mensaje..."></textarea>
                
                <!-- Bot√≥n Enviar -->
                <button id="enviarMensaje" class="action-btn" style="color:var(--accent);" title="Enviar">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- =========================================
     PARTE 3: EL CEREBRO (L√ìGICA LOCAL Y FIREBASE)
     ========================================= -->

<!-- SCRIPT 1: L√ìGICA LOCAL (Frases, Poemas y Apertura) -->
<script>
    // --- 1. BANCO DE DATOS ROM√ÅNTICO ---
    const FRASES = {
        feliz: [
            "Tu sonrisa ilumina mi oscuridad.", 
            "Me encanta verte brillar, mi ni√±a.", 
            "Guarda este momento en tu coraz√≥n para siempre.", 
            "Hoy es un d√≠a perfecto porque sonr√≠es."
        ],
        triste: [
            "Estoy aqu√≠, sosteniendo tu mano a la distancia.", 
            "Esto tambi√©n pasar√°, mi amor. Conf√≠a.", 
            "Eres m√°s fuerte de lo que crees.", 
            "Llora si lo necesitas, yo recojo tus l√°grimas."
        ],
        estresada: [
            "Respira. Inhala, exhala. Todo estar√° bien.", 
            "T√≥mate un descanso, el mundo puede esperar.", 
            "Cierra los ojos e imagina que te abrazo fuerte.",
            "Un paso a la vez, no tienes que correr."
        ],
        cansada: [
            "Descansa, guerrera. Te mereces paz.", 
            "Deja que el sue√±o repare tus alas.", 
            "Buenas noches, mi vida.", 
            "Ma√±ana ser√° otro d√≠a lleno de luz."
        ],
        extra√±andote: [
            "Yo te extra√±o m√°s, te lo aseguro.", 
            "La distancia es solo f√≠sica, mi alma est√° contigo.", 
            "Pronto nos veremos, lo prometo.",
            "Cuento los d√≠as para volver a verte."
        ],
        pensandoEnTi: [
            "T√∫ vives en mi mente 24/7.", 
            "Eres mi pensamiento favorito del d√≠a.", 
            "¬øCoincidencia? Yo tambi√©n pensaba en ti justo ahora.",
            "No sales de mi cabeza (y no quiero que salgas)."
        ],
        conGanasDeVerte: [
            "Cuento los segundos para verte.", 
            "Un abrazo tuyo lo cura todo.", 
            "Ya falta menos, amor.", 
            "Quiero ver esos ojos brillar frente a m√≠."
        ],
        conGanasDePensar: [
            "Mente sucia, coraz√≥n contento üòè", 
            "Me encanta cuando te pones as√≠...", 
            "Hablemos de eso... en detalle.", 
            "Tengo las mismas ganas que t√∫."
        ]
    };

    const POEMAS = [
        "ENTRE N√öMEROS Y LETRAS\n\nEntre n√∫meros y letras\nsurgi√≥ una rosa en una libreta.\nEntre ecuaciones y canciones\nsurgieron nuestros amores.",
        "TOMA MI MANO\n\nToma mi mano,\ny acomp√°√±ame al camino\nde la vida.\n\nToma mi mano,\ny recorramos la senda,\nde por vida.",
        "AMOR ETERNO\n\nPodr√° nublarse el sol eternamente;\nPodr√° secarse en un instante el mar;\nPodr√° romperse el eje de la tierra\nComo un d√©bil cristal.\n¬°todo suceder√°! Podr√° la muerte\nCubrirme con su f√∫nebre cresp√≥n;\nPero jam√°s en m√≠ podr√° apagarse\nLa llama de tu amor."
    ];

    // --- 2. FUNCIONES DE INTERFAZ LOCAL ---
    
    function mostrarMensaje() {
        const emocion = document.getElementById('emocion').value;
        const lista = FRASES[emocion] || ["Te quiero."];
        const frase = lista[Math.floor(Math.random() * lista.length)];
        
        const div = document.getElementById('mensaje');
        div.textContent = frase;
        div.style.display = 'block';
        
        // Disparar evento personalizado para que Firebase lo registre
        const event = new CustomEvent('emocionRegistrada', { detail: emocion });
        document.dispatchEvent(event);
    }

    function mostrarPoema() {
        const poema = POEMAS[Math.floor(Math.random() * POEMAS.length)];
        const div = document.getElementById('poema');
        div.textContent = poema;
        div.style.display = 'block';
    }

    // --- 3. EL TRIGGER (ABRIR PUERTA SECRETA) ---
    document.getElementById('palabra-secreta').addEventListener('click', (e) => {
        e.preventDefault();
        const seccion = document.getElementById('seccion-secreta');
        seccion.style.display = 'block';
        // El script de Firebase decidir√° si muestra Login o App
    });
    
    // Toggle Password
    document.getElementById('togglePassword').addEventListener('click', () => {
        const input = document.getElementById('password');
        input.type = input.type === "password" ? "text" : "password";
    });

</script>

<!-- SCRIPT 2: EL CEREBRO DE LA NUBE (FIREBASE) -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getDatabase, ref, push, onChildAdded, get, set, onValue, serverTimestamp, remove, query, limitToLast, orderByChild } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // --- CONFIGURACI√ìN ---
    const firebaseConfig = {
        apiKey: "AIzaSyAcweOs5qS3v4xbzmkYCFLKxVaSWVsly_M",
        authDomain: "estrellita-chl.firebaseapp.com",
        databaseURL: "https://estrellita-chl-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "estrellita-chl",
        storageBucket: "estrellita-chl.firebasestorage.app",
        messagingSenderId: "1006618062076",
        appId: "1:1006618062076:web:8cc3a6bb3ebe800d11fb79",
        measurementId: "G-X2K8ZCR608"
    };

    // Inicializar
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    const USUARIO_ESTRELLITA = "oras5982";
    const USUARIO_ADMIN = "jahaziel.alvarezreyes";

    // Referencias DOM
    const dom = {
        loginContainer: document.getElementById('loginContainer'),
        appContainer: document.getElementById('contenido-secreto'),
        email: document.getElementById('email'),
        pass: document.getElementById('password'),
        loginBtn: document.getElementById('login'),
        logoutBtn: document.getElementById('logout'),
        chatWindow: document.getElementById('chat'),
        msgInput: document.getElementById('mensajeInput'),
        sendBtn: document.getElementById('enviarMensaje'),
        fileBtn: document.getElementById('btnUpload'),
        fileInput: document.getElementById('imageInput'),
        adminPanel: document.getElementById('admin-info'),
        borrarBtn: document.getElementById('borrarChatBtn'),
        statsDiv: document.getElementById('contadores-container'),
        errorMsg: document.getElementById('loginError')
    };

    let currentUser = null;
    let mensajesVistos = new Set();

    // --- AUTENTICACI√ìN ---
    
    dom.loginBtn.addEventListener('click', () => {
        const e = dom.email.value;
        const p = dom.pass.value;
        dom.errorMsg.textContent = "";
        
        signInWithEmailAndPa